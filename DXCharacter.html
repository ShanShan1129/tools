<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>å®Ÿé¨“å ´</title>
</head>

<body>
    <p>ãªã‚‹ã»ã©ãªğŸŒ³</p>
    <form name="myform">
        <input name="title" type="text" value="Hello World1" />
        <input name="btn" type="button" value="å®Ÿè¡Œ" onclick="makeDXCharacter()"/>
    </form>
</body>
<script type="text/javascript">
    makeDXCharacter = function () {
        var charURLstr = document.forms.myform.title.value;
        var charURL;
        try {
            charURL = new URL(charURLstr);
        } catch (error) {
            alert("ğŸŒˆ");
        }
        if (charURL.hostname !== "character-sheets.appspot.com" || !charURL.pathname.match(/\/dx3\/edit\.html$/) || !charURL.search || !navigator.clipboard) {
            alert("error OCN");
            return
        }
        var s = document.createElement("script");
        s.src = "https://" + charURL.hostname + "/dx3/display?ajax=1&callback=OCLDX3&key=" + (new URLSearchParams(charURL.search).get('key'));
        OCLDX3 = function (data) {
            var data2 = {
                "kind": "character",
                "data": {
                    "name": data.base.name || data.base.nameKana,
                    "externalUrl": charURL.href,
                    "initiative": Number(data.subAbility.action.total) || 0,
                    "status": [
                        {
                            "label": "HP",
                            "value": data.subAbility.hp.total,
                            "max": data.subAbility.hp.total
                        },
                        {
                            "label": "ä¾µè•ç‡",
                            "value": data.subAbility.erotion.total,
                            "max": data.subAbility.erotion.total
                        },
                        {
                            "label": "ãƒ­ã‚¤ã‚¹",
                            "value": 3,
                            "max": 7
                        },
                        {
                            "label": "ä¾µè•ç‡B",
                            "value": "",
                            "max": ""
                        },
                        {
                            "label": "è²¡ç”£P",
                            "value": data.subAbility.property.total,
                            "max": data.subAbility.property.total
                        }
                    ],
                    "params": [
                        {
                            "label": "è‚‰ä½“",
                            "value": data.baseAbility.body.total
                        },
                        {
                            "label": "æ„Ÿè¦š",
                            "value": data.baseAbility.sense.total
                        },
                        {
                            "label": "ç²¾ç¥",
                            "value": data.baseAbility.mind.total
                        },
                        {
                            "label": "ç¤¾ä¼š",
                            "value": data.baseAbility.society.total
                        }
                    ],
                    "active": true,
                    "secret": false,
                    "invisible": false,
                    "hideStatus": false,
                    "commands": "â—†æ±ç”¨ãƒãƒ£ãƒƒãƒˆãƒ‘ãƒ¬ãƒƒãƒˆ\n//ä¸Šæ˜‡\n{ä¾µè•ç‡}+1d10ã€€ç™»å ´/ãƒªã‚¶ãƒ¬ã‚¯ãƒˆ\n{ä¾µè•ç‡}+nd10ã€€ã‚¸ã‚§ãƒã‚·ãƒ•ãƒˆ\n{ä¾µè•ç‡}+2d10ã€€è¡å‹•åˆ¤å®š\n\n//åˆ¤å®šç”¨\n({è‚‰ä½“}+{ä¾µè•ç‡B})dxã€€ã€è‚‰ä½“ã€‘\n({æ„Ÿè¦š}+{ä¾µè•ç‡B})dxã€€ã€æ„Ÿè¦šã€‘\n({ç²¾ç¥}+{ä¾µè•ç‡B})dxã€€ã€ç²¾ç¥ã€‘\n({ç¤¾ä¼š}+{ä¾µè•ç‡B})dxã€€ã€ç¤¾ä¼šã€‘\n\n({æ„Ÿè¦š}+{ä¾µè•ç‡B})dxã€€ã€ˆçŸ¥è¦šã€‰\n({ç²¾ç¥}+{ä¾µè•ç‡B})dxã€€ã€ˆæ„å¿—ã€‰\n\n({è‚‰ä½“}+{ä¾µè•ç‡B})dxã€€ã€ˆé‹è»¢ï¼šã€‰\n({æ„Ÿè¦š}+{ä¾µè•ç‡B})dxã€€ã€ˆèŠ¸è¡“ï¼šã€‰\n({ç²¾ç¥}+{ä¾µè•ç‡B})dxã€€ã€ˆçŸ¥è­˜ï¼šã€‰\n({ç¤¾ä¼š}+{ä¾µè•ç‡B})dxã€€ã€ˆæƒ…å ±ï¼šã€‰\n\n//å‘½ä¸­+ã‚³ãƒ³ãƒœ\nã‚³ãƒ³ãƒœã€åç§°ã€ã‚¿ã‚¤ãƒŸãƒ³ã‚°/æŠ€èƒ½/å°„ç¨‹/å¯¾è±¡/ä¾µè•ç‡n/åŠ¹æœ\n({}+{ä¾µè•ç‡B})dx8ã€€99â†“\n({}+{ä¾µè•ç‡B})dx7ã€€100â†‘\n\nd10+\nd10+\n\n//å›é¿\n({è‚‰ä½“}+{ä¾µè•ç‡B})dxã€€ã€ˆå›é¿ã€‰\n\n//ãƒãƒƒã‚¯ãƒˆãƒ©ãƒƒã‚¯\nè‡ªå·±ç”³å‘Š\nä¾µè•ç‡{ä¾µè•ç‡}% ãƒ­ã‚¤ã‚¹{ãƒ­ã‚¤ã‚¹}å€‹\n\n{ä¾µè•ç‡}-{ãƒ­ã‚¤ã‚¹}d10ã€€é€šå¸¸æŒ¯ã‚Š/è¿½åŠ æŒ¯ã‚Š\n{ä¾µè•ç‡}-({ãƒ­ã‚¤ã‚¹}+{ãƒ­ã‚¤ã‚¹})d10ã€€2å€æŒ¯ã‚Š"
                }
            };

            var Text = JSON.stringify(data2);
            navigator.clipboard.writeText(Text)
                .then(function () {
                    alert('ã‚¯ãƒªãƒƒãƒ—ãƒœãƒ¼ãƒ‰ã«å‡ºåŠ›ãƒ»çš‡\nã‚³ã‚³ãƒ•ã‚©ãƒªã‚¢ç›¤é¢ã«å¼µã‚Šä»˜ã‘ã¦ãã‚Œ(^^)');
                })
                .catch(err => {
                    data2.data.commands = "";
                    window.prompt('ãƒœãƒƒã‚¯ã‚¹å†…ã®æ–‡å­—ã‚’ã‚³ãƒ”ãƒšã—ã¦ã‚³ã‚³ãƒ•ã‚©ãƒªã‚¢ç›¤é¢ã«å¼µã‚Šä»˜ã‘ã¦ãã‚Œ(^^)', JSON.stringify(data2));
                });
        };
        document.body.appendChild(s);
    }
</script>

</html>